     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_init_gdtidt
     7 00000000                                 	EXTERN	_init_pic
     8 00000000                                 	EXTERN	_io_sti
     9 00000000                                 	EXTERN	_keyfifo
    10 00000000                                 	EXTERN	_fifo8_init
    11 00000000                                 	EXTERN	_mousefifo
    12 00000000                                 	EXTERN	_io_out8
    13 00000000                                 	EXTERN	_init_palette
    14 00000000                                 	EXTERN	_init_screen
    15 00000000                                 	EXTERN	_init_mouse_cursor8
    16 00000000                                 	EXTERN	_putblock8_8
    17 00000000                                 	EXTERN	_io_cli
    18 00000000                                 	EXTERN	_fifo8_status
    19 00000000                                 	EXTERN	_fifo8_get
    20 00000000                                 	EXTERN	_sprintf
    21 00000000                                 	EXTERN	_boxfill8
    22 00000000                                 	EXTERN	_putfonts8_asc
    23 00000000                                 	EXTERN	_io_stihlt
    24 00000000                                 	EXTERN	_io_in8
    25 00000000                                 [FILE "bootpack.c"]
    26                                          [SECTION .data]
    27 00000000                                 LC0:
    28 00000000 25 30 32 78 00                  	DB	"%02x",0x00
    29                                          [SECTION .text]
    30 00000000                                 	GLOBAL	_ZuviMain
    31 00000000                                 _ZuviMain:
    32 00000000 55                              	PUSH	EBP
    33 00000001 89 E5                           	MOV	EBP,ESP
    34 00000003 57                              	PUSH	EDI
    35 00000004 56                              	PUSH	ESI
    36 00000005 53                              	PUSH	EBX
    37 00000006 8D 9D FFFFFE84                  	LEA	EBX,DWORD [-380+EBP]
    38 0000000C 81 EC 00000210                  	SUB	ESP,528
    39 00000012 E8 [00000000]                   	CALL	_init_gdtidt
    40 00000017 E8 [00000000]                   	CALL	_init_pic
    41 0000001C E8 [00000000]                   	CALL	_io_sti
    42 00000021 8D 85 FFFFFE64                  	LEA	EAX,DWORD [-412+EBP]
    43 00000027 50                              	PUSH	EAX
    44 00000028 6A 20                           	PUSH	32
    45 0000002A 68 [00000000]                   	PUSH	_keyfifo
    46 0000002F E8 [00000000]                   	CALL	_fifo8_init
    47 00000034 8D 85 FFFFFDE4                  	LEA	EAX,DWORD [-540+EBP]
    48 0000003A 50                              	PUSH	EAX
    49 0000003B 68 00000080                     	PUSH	128
    50 00000040 68 [00000000]                   	PUSH	_mousefifo
    51 00000045 E8 [00000000]                   	CALL	_fifo8_init
    52 0000004A 68 000000F9                     	PUSH	249
    53 0000004F 6A 21                           	PUSH	33
    54 00000051 E8 [00000000]                   	CALL	_io_out8
    55 00000056 83 C4 20                        	ADD	ESP,32
    56 00000059 68 000000EF                     	PUSH	239
    57 0000005E 68 000000A1                     	PUSH	161
    58 00000063 E8 [00000000]                   	CALL	_io_out8
    59 00000068 E8 00000180                     	CALL	_init_keyboard
    60 0000006D E8 [00000000]                   	CALL	_init_palette
    61 00000072 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
    62 00000079 50                              	PUSH	EAX
    63 0000007A 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    64 00000081 50                              	PUSH	EAX
    65 00000082 FF 35 00000FF8                  	PUSH	DWORD [4088]
    66 00000088 E8 [00000000]                   	CALL	_init_screen
    67 0000008D B9 00000002                     	MOV	ECX,2
    68 00000092 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    69 00000099 8D 50 F0                        	LEA	EDX,DWORD [-16+EAX]
    70 0000009C 89 D0                           	MOV	EAX,EDX
    71 0000009E 99                              	CDQ
    72 0000009F F7 F9                           	IDIV	ECX
    73 000000A1 0F BF 15 00000FF6               	MOVSX	EDX,WORD [4086]
    74 000000A8 83 EA 2C                        	SUB	EDX,44
    75 000000AB 89 C7                           	MOV	EDI,EAX
    76 000000AD 89 D0                           	MOV	EAX,EDX
    77 000000AF 6A 0D                           	PUSH	13
    78 000000B1 99                              	CDQ
    79 000000B2 F7 F9                           	IDIV	ECX
    80 000000B4 53                              	PUSH	EBX
    81 000000B5 89 C6                           	MOV	ESI,EAX
    82 000000B7 E8 [00000000]                   	CALL	_init_mouse_cursor8
    83 000000BC 6A 10                           	PUSH	16
    84 000000BE 53                              	PUSH	EBX
    85 000000BF 56                              	PUSH	ESI
    86 000000C0 57                              	PUSH	EDI
    87 000000C1 6A 10                           	PUSH	16
    88 000000C3 6A 10                           	PUSH	16
    89 000000C5 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    90 000000CC 50                              	PUSH	EAX
    91 000000CD FF 35 00000FF8                  	PUSH	DWORD [4088]
    92 000000D3 E8 [00000000]                   	CALL	_putblock8_8
    93 000000D8 83 C4 3C                        	ADD	ESP,60
    94 000000DB E8 0000012E                     	CALL	_enable_mouse
    95 000000E0                                 L2:
    96 000000E0 E8 [00000000]                   	CALL	_io_cli
    97 000000E5 68 [00000000]                   	PUSH	_keyfifo
    98 000000EA E8 [00000000]                   	CALL	_fifo8_status
    99 000000EF 68 [00000000]                   	PUSH	_mousefifo
   100 000000F4 89 C3                           	MOV	EBX,EAX
   101 000000F6 E8 [00000000]                   	CALL	_fifo8_status
   102 000000FB 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   103 000000FE 5B                              	POP	EBX
   104 000000FF 5E                              	POP	ESI
   105 00000100 85 C0                           	TEST	EAX,EAX
   106 00000102 0F 84 000000C9                  	JE	L11
   107 00000108 68 [00000000]                   	PUSH	_keyfifo
   108 0000010D E8 [00000000]                   	CALL	_fifo8_status
   109 00000112 59                              	POP	ECX
   110 00000113 85 C0                           	TEST	EAX,EAX
   111 00000115 75 71                           	JNE	L12
   112 00000117 68 [00000000]                   	PUSH	_mousefifo
   113 0000011C E8 [00000000]                   	CALL	_fifo8_status
   114 00000121 5A                              	POP	EDX
   115 00000122 85 C0                           	TEST	EAX,EAX
   116 00000124 74 BA                           	JE	L2
   117 00000126 68 [00000000]                   	PUSH	_mousefifo
   118 0000012B E8 [00000000]                   	CALL	_fifo8_get
   119 00000130 89 C3                           	MOV	EBX,EAX
   120 00000132 E8 [00000000]                   	CALL	_io_sti
   121 00000137 53                              	PUSH	EBX
   122 00000138 8D 5D 84                        	LEA	EBX,DWORD [-124+EBP]
   123 0000013B 68 [00000000]                   	PUSH	LC0
   124 00000140 53                              	PUSH	EBX
   125 00000141 E8 [00000000]                   	CALL	_sprintf
   126 00000146 6A 1F                           	PUSH	31
   127 00000148 6A 2F                           	PUSH	47
   128 0000014A 6A 10                           	PUSH	16
   129 0000014C 6A 00                           	PUSH	0
   130 0000014E 6A 0D                           	PUSH	13
   131 00000150 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   132 00000157 50                              	PUSH	EAX
   133 00000158 FF 35 00000FF8                  	PUSH	DWORD [4088]
   134 0000015E E8 [00000000]                   	CALL	_boxfill8
   135 00000163 83 C4 2C                        	ADD	ESP,44
   136 00000166 53                              	PUSH	EBX
   137 00000167 6A 07                           	PUSH	7
   138 00000169 6A 10                           	PUSH	16
   139 0000016B 6A 20                           	PUSH	32
   140 0000016D                                 L10:
   141 0000016D 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   142 00000174 50                              	PUSH	EAX
   143 00000175 FF 35 00000FF8                  	PUSH	DWORD [4088]
   144 0000017B E8 [00000000]                   	CALL	_putfonts8_asc
   145 00000180 83 C4 18                        	ADD	ESP,24
   146 00000183 E9 FFFFFF58                     	JMP	L2
   147 00000188                                 L12:
   148 00000188 68 [00000000]                   	PUSH	_keyfifo
   149 0000018D E8 [00000000]                   	CALL	_fifo8_get
   150 00000192 89 C3                           	MOV	EBX,EAX
   151 00000194 E8 [00000000]                   	CALL	_io_sti
   152 00000199 53                              	PUSH	EBX
   153 0000019A 8D 5D 84                        	LEA	EBX,DWORD [-124+EBP]
   154 0000019D 68 [00000000]                   	PUSH	LC0
   155 000001A2 53                              	PUSH	EBX
   156 000001A3 E8 [00000000]                   	CALL	_sprintf
   157 000001A8 6A 1F                           	PUSH	31
   158 000001AA 6A 0F                           	PUSH	15
   159 000001AC 6A 10                           	PUSH	16
   160 000001AE 6A 00                           	PUSH	0
   161 000001B0 6A 0D                           	PUSH	13
   162 000001B2 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   163 000001B9 50                              	PUSH	EAX
   164 000001BA FF 35 00000FF8                  	PUSH	DWORD [4088]
   165 000001C0 E8 [00000000]                   	CALL	_boxfill8
   166 000001C5 83 C4 2C                        	ADD	ESP,44
   167 000001C8 53                              	PUSH	EBX
   168 000001C9 6A 07                           	PUSH	7
   169 000001CB 6A 10                           	PUSH	16
   170 000001CD 6A 00                           	PUSH	0
   171 000001CF EB 9C                           	JMP	L10
   172 000001D1                                 L11:
   173 000001D1 E8 [00000000]                   	CALL	_io_stihlt
   174 000001D6 E9 FFFFFF05                     	JMP	L2
   175 000001DB                                 	GLOBAL	_wait_keyboard_controller_sendready
   176 000001DB                                 _wait_keyboard_controller_sendready:
   177 000001DB 55                              	PUSH	EBP
   178 000001DC 89 E5                           	MOV	EBP,ESP
   179 000001DE                                 L14:
   180 000001DE 6A 64                           	PUSH	100
   181 000001E0 E8 [00000000]                   	CALL	_io_in8
   182 000001E5 5A                              	POP	EDX
   183 000001E6 83 E0 02                        	AND	EAX,2
   184 000001E9 75 F3                           	JNE	L14
   185 000001EB C9                              	LEAVE
   186 000001EC C3                              	RET
   187 000001ED                                 	GLOBAL	_init_keyboard
   188 000001ED                                 _init_keyboard:
   189 000001ED 55                              	PUSH	EBP
   190 000001EE 89 E5                           	MOV	EBP,ESP
   191 000001F0 E8 FFFFFFE6                     	CALL	_wait_keyboard_controller_sendready
   192 000001F5 6A 60                           	PUSH	96
   193 000001F7 6A 64                           	PUSH	100
   194 000001F9 E8 [00000000]                   	CALL	_io_out8
   195 000001FE E8 FFFFFFD8                     	CALL	_wait_keyboard_controller_sendready
   196 00000203 6A 47                           	PUSH	71
   197 00000205 6A 60                           	PUSH	96
   198 00000207 E8 [00000000]                   	CALL	_io_out8
   199 0000020C C9                              	LEAVE
   200 0000020D C3                              	RET
   201 0000020E                                 	GLOBAL	_enable_mouse
   202 0000020E                                 _enable_mouse:
   203 0000020E 55                              	PUSH	EBP
   204 0000020F 89 E5                           	MOV	EBP,ESP
   205 00000211 E8 FFFFFFC5                     	CALL	_wait_keyboard_controller_sendready
   206 00000216 68 000000D4                     	PUSH	212
   207 0000021B 6A 64                           	PUSH	100
   208 0000021D E8 [00000000]                   	CALL	_io_out8
   209 00000222 E8 FFFFFFB4                     	CALL	_wait_keyboard_controller_sendready
   210 00000227 68 000000F4                     	PUSH	244
   211 0000022C 6A 60                           	PUSH	96
   212 0000022E E8 [00000000]                   	CALL	_io_out8
   213 00000233 C9                              	LEAVE
   214 00000234 C3                              	RET
